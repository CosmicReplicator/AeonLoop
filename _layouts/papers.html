<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>{{ page.title }}</title>
  <link rel="stylesheet" href="{{ '/css/styles.css' | relative_url }}">

  <!-- SEO -->
  {% if page.description %}
    <meta name="description" content="{{ page.description }}">
  {% endif %}
  {% if page.topics %}
    <meta name="keywords" content="{{ page.topics | join: ', ' }}">
  {% else %}
    <meta name="keywords"
          content="CosmicReplicator, AeonLoop, Discrete Spacetime, Quantum Geometry, Emergent Constants, 2.667D, Digital Tick, Fractional Dimensions, Ad Hoc-Free Formulation, Discrete Rotations">
  {% endif %}

  <!-- MathJax 3: config FIRST, then load the script -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath:  [['\\(', '\\)'], ['$', '$']],
        displayMath: [['\

\[', '\\]

'], ['$$', '$$']],
        processEscapes: true
      }
    };
  </script>

  <!-- Load order: polyfill → MathJax → Mermaid -->
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({ startOnLoad: true, securityLevel: 'loose' });
  </script>
</head>

<body>
  <div class="page-content">
    <header>
      <h1>{{ page.title }}</h1>
      <p class="meta">
        By {% if page.author %}{{ page.author }}{% else %}{{ site.author }}{% endif %}
        {% if page.date %} on {{ page.date | date: "%B %-d, %Y" }}{% endif %}
      </p>
    </header>

    <main>
      {% include sections.html %}
      {{ content | markdownify }}
    </main>

    <footer>
      {% include footer.html %}
    </footer>
  </div>
</body>
</html>
